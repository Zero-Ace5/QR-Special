<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>QR Page</title>
    <style>
        img {
            border: 3px solid;
        }

        a {
            display: block;
        }
    </style>
</head>

<body>
    <h1>Your QR is here:</h1>

    <!-- Generate form (keeps the previous value) -->
    <form method="POST">
        <input type="text" name="qr_text" placeholder="Enter URL or text" required
            value="{{ qr_data if qr_data else '' }}">
        <button type="submit" name="action" value="generate">Generate</button>
    </form>

    {% if QR_IMG %}
    <h3>For: {{ qr_data }}</h3>
    <img src="data:image/png;base64,{{ QR_IMG }}" alt="QR Code">

    <!-- Separate POST form for downloading: must include the same qr_text -->
    <form method="POST" style="margin-top:10px;">
        <input type="hidden" name="qr_text" value="{{ qr_data }}">
        <button type="submit" name="action" value="download">Download QR</button>
    </form>

    {% if qr_url %}
    <p><a href="{{ qr_url }}" target="_blank" rel="noopener noreferrer">Open {{ qr_url }}</a></p>
    {% else %}
    <p class="note">Input looks like plain text (not a clickable URL).</p>
    {% endif %}
    {% endif %}
</body>

</html>